{
	"policy_head":
	{
		"name":"key_trigger",
       		"type":"DELIVER",
        	"sender":"key_req",
	},
	"MATCH_RULES":
	[
		{	"op":"AND","area":"HEAD","type":"USER_DEFINE","subtype":"LOGIN"}
	],
	"ROUTE_RULES":
	{
		"main_policy":[
			{"target_type":"LOCAL","target_name":"key_manage"},
		]
	}
}
{
	"policy_head":
	{
		"name":"pik_check",
       		"type":"DELIVER",
        	"sender":"key_manage",
	},
	"MATCH_RULES":
	[
		{	"op":"AND","area":"HEAD","type":"MESSAGE","subtype":"INSTANCE_INFO"}
	],
	"ROUTE_RULES":
	{
		"main_policy":[
			{"target_type":"LOCAL","target_name":"key_check"},
		]
	}
}
{
	"policy_head":
	{
		"name":"pikreq",
       		"type":"QUERY",
        	"sender":"key_check",
	},
	"MATCH_RULES":
	[
		{	"op":"AND","area":"HEAD","type":"TCM_PIK_DESC","subtype":"USERINFO"}
	],
	"ROUTE_RULES":
	{
		"main_policy":[
			{"target_type":"LOCAL","target_name":"pik_client"},
			{"target_type":"CONN","target_name":"pik_client"}
		],
		"response_policy":[
			{"target_type":"LOCAL","target_name":"pik_client"},
			{"target_type":"LOCAL","target_name":"pikcert_store"},
			{"target_type":"LOCAL","target_name":"localkey_gen"},
		]
	}
}
{
        "policy_head":
        {
                "name":"localkey_gen2",
                "type":"DELIVER",
                "sender":"localkey_gen"
        },
        "MATCH_RULES":
        [
                {       "op":"AND","area":"HEAD","type":"TCM_KEY_DESC"}
        ],
        "ROUTE_RULES":
        {
                "main_policy":[
                        {"target_type":"LOCAL","target_name":"create_key"},
                        {"target_type":"LOCAL","target_name":"localkey_gen"}
                ]
        }
}
{
        "policy_head":
        {
                "name":"localkey_store",
                "type":"DELIVER",
                "sender":"localkey_gen"
        },
        "MATCH_RULES":
        [
                {       "op":"AND","area":"HEAD","type":"MESSAGE"}
        ],
        "ROUTE_RULES":
        {
                "main_policy":[
                        {"target_type":"LOCAL","target_name":"recordlib"}
                ]
        }
}
{
        "policy_head":
        {
                "name":"localkey_store2",
                "type":"DELIVER",
                "sender":"create_key"
        },
        "MATCH_RULES":
        [
                {       "op":"AND","area":"HEAD","type":"MESSAGE"}
        ],
        "ROUTE_RULES":
        {
                "main_policy":[
                        {"target_type":"LOCAL","target_name":"recordlib"}
                ]
        }
}
{
        "policy_head":
        {
                "name":"remotekey_req",
                "type":"QUERY",
                "sender":"connector_proc"
        },
        "MATCH_RULES":
        [
                {       "op":"AND","area":"HEAD","type":"GENERAL_RETURN","subtype":"STRING"}
        ],
        "ROUTE_RULES":
        {
                "main_policy":[
                        {"target_type":"LOCAL","target_name":"key_manage"},
                        {"target_type":"LOCAL","target_name":"remotekey_gen"},
                        {"target_type":"LOCAL","target_name":"remotekey_send"},
                        {"target_type":"LOCAL","target_name":"file_dealer"},
                ]
        }
}
